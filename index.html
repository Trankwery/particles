<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>particles: Cząstki</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="MathJax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="czastki2.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">particles
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Wygenerowano przez Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Szukaj');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Strona&#160;główna</span></a></li>
      <li><a href="pages.html"><span>Dodatkowe&#160;strony</span></a></li>
      <li><a href="annotated.html"><span>Klasy</span></a></li>
      <li><a href="files.html"><span>Pliki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Szukaj" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Klasy</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Pliki</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Funkcje</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Zmienne</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Definicje typów</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Wyliczenia</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Wartości wyliczeń</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Definicje</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Strony</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Cząstki </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Autor</dt><dd>Tomasz Jakubczyk </dd></dl>
<h1><a class="anchor" id="swtep"></a>
Wstęp</h1>
<p>Program symuluje kroplę cieczy z nanocząstkami w środku (zwiesina) w pułapce. W zawiesini może znajdować się kilka różnych rodzajów nanocząstek. Symulowane są odziaływania między nanocząstkami między sobą oraz z napięciem powierzchniowym kropli, która paruje zwmniejszając swój promień. Możliwe jest też opuszczenie kryształu, który pozostał po wyparowaniu cieczy na płaską powierzchnię na dnie pułapki. Obecnie zakłada się, że nanocząstki są sztywnymi kulami i wylicznay jest potencjał Lennarda-Jonesa. </p>
<h2><a class="anchor" id="parametry"></a>
Uwzględniane Parametry Symulacji</h2>
<ul>
<li>Krok czasu obliczeń.</li>
<li>Lepkość cieczy.</li>
<li>Efektywna grawitacja.</li>
<li>Napięcie powierzchniowe.</li>
<li>Współczynnik proporcjonalny potencjału Lennarda-Jonesa.</li>
<li>Współczynnik ruchów Browna.</li>
<li>Odpychanie Coulombowskie.</li>
<li>Ilości różnych rodzajów cząstek wraz z ich promieniami i masami (lub gęstościami).</li>
<li>Szybkość parowania kropli. </li>
</ul>
<h1><a class="anchor" id="Opis_Ogólny"></a>
Opis Ogólny</h1>
<ul>
<li>Cząstki dzielone są na komórki według ich położenia. (<a class="el" href="particle_system__cuda_8cu.html#ae0a4037d25e768622443077546399cf2">calcHash</a>, <a class="el" href="particle_system__cuda_8cu.html#ac71da7e4672a2732a098ba933a799257">sortParticles</a>, <a class="el" href="particle_system__cuda_8cu.html#ac72ccd068434c46c2f901c751d53be1d">reorderDataAndFindCellStart</a>)</li>
<li>Dla każdej cząstki wyliczana jest siła jaka na nią zadziała. Składa się ona ze zderzeń ze wszystkimi cząstkami w zasięgu, muszą one być w tej samej komórce, albo w sąsiedniej. (<a class="el" href="particle_system__cuda_8cu.html#ad9d704d76ddff93e75ca7d39f57bbced">collide</a>)</li>
<li>Prędkość jest wyliczana z poprzedniej prękości i sił. Wyliczana jest nowa pozycja na podstawie kroku czasu i prędkości. (<a class="el" href="particle_system__cuda_8cu.html#acc6f80275c68628897944a5654d339fe" title="Całkowanie ruchu każdej cząstki. ">integrateSystem</a>) </li>
</ul>
<h1><a class="anchor" id="wzory_w_kodzie"></a>
Wzory W Kodzie</h1>
<ul>
<li>Zderzenie dwóch cząstek: <a class="el" href="particles__kernel__impl_8cuh.html#a0558bfe8fc21ab0bfa0685ece3ff81a3" title="collide two spheres using DEM method ">collideSpheres</a> w <a class="el" href="particles__kernel__impl_8cuh.html" title="Implementacje (definicje) funkcji odpowiadających za fizykę. ">particles_kernel_impl.cuh</a></li>
<li>Lepkość, grawitacja, wyliczanie nowej prędkości i pozycji: <b>integrate_functor::operator()(Tuple t)</b> <a class="el" href="structintegrate__functor.html" title="ta struktura inicjowana jest z krokiem delta_time dla danych opisujących prędkość i położenie cząstki...">integrate_functor</a> w <a class="el" href="particles__kernel__impl_8cuh.html" title="Implementacje (definicje) funkcji odpowiadających za fizykę. ">particles_kernel_impl.cuh</a></li>
<li>Parowanie kropli: <a class="el" href="particles_8cpp.html#ad38a0dbec46194a94a86cfa6416ce48f" title="sterowanie parowaniem kropli ">parowanieKropliWCzasie</a> w <a class="el" href="particles_8cpp.html" title="Główny plik projektu. Zawiera main i funkcje sterujące całym programem. ">particles.cpp</a> </li>
</ul>
<h1><a class="anchor" id="linki_do_fizyki"></a>
Linki do fizyki</h1>
<p><a href="http://www.cchem.berkeley.edu/chem195/_l_j___force_short_8m.html">http://www.cchem.berkeley.edu/chem195/_l_j___force_short_8m.html</a> <a href="http://phys.ubbcluj.ro/~tbeu/MD/C2_for.pdf">http://phys.ubbcluj.ro/~tbeu/MD/C2_for.pdf</a> <a href="http://www2.physics.umd.edu/~alaporta/Lennard-Jones.html">http://www2.physics.umd.edu/~alaporta/Lennard-Jones.html</a> <a href="http://www.fis.agh.edu.pl/~Burda//NEWS/Informacje%20dla%20wszystkich/CwiczenieAFM.pdf">http://www.fis.agh.edu.pl/~Burda//NEWS/Informacje%20dla%20wszystkich/CwiczenieAFM.pdf</a> <a href="http://en.wikipedia.org/wiki/Lennard-Jones_potential#Alternative_expressions">http://en.wikipedia.org/wiki/Lennard-Jones_potential#Alternative_expressions</a> <a href="https://pl.wikibooks.org/wiki/Mechanika_teoretyczna/Mechanika_teoretyczna#Doskonale_spr.C4.99.C5.BCyste_zderzenie_dw.C3.B3ch_cz.C4.85stek">https://pl.wikibooks.org/wiki/Mechanika_teoretyczna/Mechanika_teoretyczna#Doskonale_spr.C4.99.C5.BCyste_zderzenie_dw.C3.B3ch_cz.C4.85stek</a> </p>
<h1><a class="anchor" id="Repozytorium"></a>
Repozytorium</h1>
<p><a href="https://github.com/sigrond/particles">https://github.com/sigrond/particles</a> </p>
<h2><a class="anchor" id="dokumentacja_repozytorium"></a>
Dokumentacja Repozytorium</h2>
<p><a href="http://sigrond.github.io/particles">http://sigrond.github.io/particles</a> </p>
<h1><a class="anchor" id="READMEs"></a>
READMEs</h1>
<h2><a class="anchor" id="parametry_uruchamiania"></a>
Parametry Uruchamiania</h2>
<pre class="fragment">cmd line
particles -nazwaParametru=liczba

np:
particles -bigRadius0=0.1
bigRadius0 -początkowy promień kropli
n -ilość cząstek
grid -rozmiar gridu
file -nazwa pliku do porównania z wynikiem
timestep -krok czasu
benchmark -obliczenia bez GUI, pokazuje wydajność
i -ilość kroków
device -wybór GPU
epsi -epsilon w sile lenarda jonesa
damping -lepkość
boundaryDamping -napięcie powierchniowe
particleMass -masa cząstki
gravity -grawitacja
save -zapis do pliku
A -stała parowania kropli
particleTypesNum -ilość rodzjów cząstek
bQuality -liczba naturalna
brown -mnożnik róchów Browna
multiColor -losowe kolory kulek
help
</pre> <h2><a class="anchor" id="oryginalny_readme"></a>
Oryginalny Readme</h2>
<pre class="fragment">Sample: Particles
Minimum spec: GeForce 8

This sample uses CUDA to simulate and visualize a large set of particles and their physical interaction.  Adding "-particles=&lt;N&gt;" to the command line will allow users to set # of particles for simulation.  This example implements a uniform grid data structure using either atomic operations or a fast radix sort from the Thrust library

Key concepts:
</pre> <h2><a class="anchor" id="koncepcja_symulowania_roznych_czastek"></a>
Koncepcja symulowania różnych cząstek</h2>
<pre class="fragment">	Autor: Tomasz Jakubczyk
Plan dodania obsługi wielu rodzajów cząstek na raz


	Koncepcja:

Żeby oszczędzać wykożystywaną pamięć karty graficznej zauważam, że całe float4 jest ładowane do pamieci.
4 pozycja zawsze zawiera 1, które jest potrzebne do transformacji GL w postaci znormalizowanej.
Oryginalnie kopiowana jest cała tablica float4 do karty graficznej mimo, że co 4 float jest tam zbędny,
jest to spowodowane tym, że kod kopiowania między pamięciami jest prostszy i nie trzeba wykonywać dodatkowych
operacji zsuwania i rozsuwania pamięci.
W efekcie w pamięci karty sę niewykożystywane pozycje zawierające 1.
Chcę to wykożystać;
ponumeruję rodzaje cząstek i przed skopiowaniem do karty będę przypisywł na 4 pozycję każdej cząstce
numer jej rodzaju, a przy wczytywaniu do głównej pamięci RAM dla GL'a będę te numery zapisywał
do osobnej tablicy i przed wykonywaniem przekształceń GL 4 pozycje zapełnie 1.

EDIT:
Lepiej użyć wektora prędkości, bo tam 4 współżędna zawsze może mieć dowolną wartość,
a nie będzie trzeba ciągle zamieniać numeru typu z 1 i niepełna implementacja
będzia miała mniejszy wpływ na działanie symulacji.
Zwiększy się też prostota rozwiązania.

EDIT:
Następnym problemem wykrytym w trakcie pisania jest rysowanie cząstek w różnych rozmiarach.
Obecnie funkcja raz zadaje rozmiar i rysuje wszystkie cząstki jako punkty za raz jako
zbiór punktów. Zgodnie z sugestią dr hab. inż. D.J. ;-) przy losowaniu cząstek typy
przypisujemy pokolei. Po pierwsze likwiduje to problemy z proporcja i rozkładem ilości
typów cząstek. Po drugie nie trzeba losować typu. Po trzecie można łatwo rozdzielić cząstki
na tyle grup ile typów i zastosować obecny algorytm rysowania dla każdej z osobna.


	Modyfikacje funkcji:

Plik particles_kernel_impl.cuh

operator() integrate_functor
Informacja o rodzaju cząstki może być przechowywana w float4 posData
w metodzie będzie trzeba uwzględnić, że cząstki mają różne promienie (params.particleRadius).

collideSpheres
Argumenty funkcji float3 należy zamienić na float4 ponieważ w tej funkcji obliczane są siły działające
na cząstki podczas zderzenia.

collideCell
Argument pos funkcji zmienić z float3 na float4.
Potrzebne są informacje o rodzaju obu cząstek i należy je uwzględnić; szczególnie różne promienie.
Odpowiednio zmodyfikować wywołanie collideSpheres.

collideD
Odpowiednio zmodyfikować wywołanie collideCell.
Uwzględnić masę cząstki zależną od jej rodzaju przy wyliczaniu nowej prędkości.

particles_kernel.cuh

SimParams
Zmienić parametry cząstek float (particleRadius, particleMass) na tablice float i odwoływać się do nich
przez numer typu cząstki.

particleSystem.cpp

Chyba gdzieś w tym pliku trzeba zadbać o zamiany 1 z numerem typu cząstki.

ParticleSystem::ParticleSystem
Ustalić parametry cząstek dla różnych typów.
Dobrze by było wcześniej mieć vector z parametrami typów cząstek.

ParticleSystem::initGrid, ParticleSystem::reset
Losować typ cząstki z dostępnych.
Powinna tu wkroczyć tablica z przypisanymi typami do cząstek.

ParticleSystem::particleType
Ustalić, czy to dobry pomysł i zintegrować z resztą.

ParticleSystem::update
Tu jest połączenie sterowania CUDA i GL.
Należy zadbać, żeby przełączanie 1 do normalizacji z numerem typu cząstki przebiegało w właściwej kolejności.

particles.cpp

Zadbać o ustalenie na początku symulacji ile będzie typów cząstek i jakie one będą.

</pre> <h2><a class="anchor" id="rezerwa"></a>
Opis formatu pliku konfiguracji typów cząstek</h2>
<p>Niestety trzeba go napisać. Domyślny plik "particleType.cfg". </p>
<pre class="fragment">particleType czastka1
{
	particleRadius=0.18;
	particleMass=0.0004;
	particleNoOfType=512;
	particleCharge=0.1;
}
particleType czastka2
{
	particleRadius=0.225;
	particleMass=0.001;
	particleNoOfType=256;
	particleCharge=0.2;
}
particleType czastka3
{
	particleRadius=0.3;
	particleMass=0.002;
	particleNoOfType=256;
	particleColorR=0.0;
	particleColorG=0.0;
	particleColorB=1.0;
	particleCharge=0.3;
}
normalizedEpsilon epsilony
{
    0.1 , 0.15 , 0.2  ,
          0.2  , 0.25 ,
                 0.3 ,
}
</pre><p> Więcej można znaleźć w "particleTypesLoader.cpp" oraz "particleType.h" </p>
<dl class="section see"><dt>Zobacz również</dt><dd><a class="el" href="classparticle_types_loader.html#a06c57d5168b0050299832b6cd617aefa" title="Załaduje dane z pliku do wektora. Plik będzie na nowo otwarty i przeczytany, a wektor wyczyszczony i ...">particleTypesLoader::loadTypes</a> <br/>
 <a class="el" href="particle_types_loader_8cpp.html" title="Definicje metod klasy particleTypesLoader. ">particleTypesLoader.cpp</a> <br/>
 <a class="el" href="classparticle_type.html#a63236e18a0217d47f16de798617a5b73" title="Vektor zawierający mnożniki epsilona do potencjału Lennarda-Jonesa. Pozycja w wektorze odpowiada prze...">particleType::normalizedEpsilon</a> <br/>
 <a class="el" href="particle_type_8h.html" title="Zawiera klase opisującą typ cząstki. ">particleType.h</a> </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Wygenerowano So, 8 sie 2015 14:53:19 dla particles programem
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
