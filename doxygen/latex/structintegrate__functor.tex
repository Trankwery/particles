\hypertarget{structintegrate__functor}{\section{Dokumentacja struktury integrate\-\_\-functor}
\label{structintegrate__functor}\index{integrate\-\_\-functor@{integrate\-\_\-functor}}
}


ta struktura inicjowana jest z krokiem delta\-\_\-time dla danych opisujących prędkość i położenie cząstki, te dane siedzą w wektorze thrust (w G\-P\-U) jako para (tuple) float4 położenia i prędkości  




Diagram współpracy dla integrate\-\_\-functor\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=184pt]{structintegrate__functor__coll__graph}
\end{center}
\end{figure}
\subsection*{Metody publiczne}
\begin{DoxyCompactItemize}
\item 
\-\_\-\-\_\-host\-\_\-\-\_\- \-\_\-\-\_\-device\-\_\-\-\_\- \hyperlink{structintegrate__functor_a13075d4c547ba22c37137ff2b874ae45}{integrate\-\_\-functor} (float delta\-\_\-time)
\item 
{\footnotesize template$<$typename Tuple $>$ }\\\-\_\-\-\_\-device\-\_\-\-\_\- void \hyperlink{structintegrate__functor_a772e86ead8690332beb50911e4448f81}{operator()} (Tuple t)
\begin{DoxyCompactList}\small\item\em nowe położenie \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Atrybuty publiczne}
\begin{DoxyCompactItemize}
\item 
float \hyperlink{structintegrate__functor_a06dce1826719cd5b2a9fdd9f566da754}{delta\-Time}
\end{DoxyCompactItemize}


\subsection{Opis szczegółowy}
ta struktura inicjowana jest z krokiem delta\-\_\-time dla danych opisujących prędkość i położenie cząstki, te dane siedzą w wektorze thrust (w G\-P\-U) jako para (tuple) float4 położenia i prędkości 

Definicja w linii \hyperlink{particles__kernel__impl_8cuh_source_l00046}{46} pliku \hyperlink{particles__kernel__impl_8cuh_source}{particles\-\_\-kernel\-\_\-impl.\-cuh}.



\subsection{Dokumentacja konstruktora i destruktora}
\hypertarget{structintegrate__functor_a13075d4c547ba22c37137ff2b874ae45}{\index{integrate\-\_\-functor@{integrate\-\_\-functor}!integrate\-\_\-functor@{integrate\-\_\-functor}}
\index{integrate\-\_\-functor@{integrate\-\_\-functor}!integrate_functor@{integrate\-\_\-functor}}
\subsubsection[{integrate\-\_\-functor}]{\setlength{\rightskip}{0pt plus 5cm}\-\_\-\-\_\-host\-\_\-\-\_\- \-\_\-\-\_\-device\-\_\-\-\_\- integrate\-\_\-functor\-::integrate\-\_\-functor (
\begin{DoxyParamCaption}
\item[{float}]{delta\-\_\-time}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{structintegrate__functor_a13075d4c547ba22c37137ff2b874ae45}


Definicja w linii \hyperlink{particles__kernel__impl_8cuh_source_l00051}{51} pliku \hyperlink{particles__kernel__impl_8cuh_source}{particles\-\_\-kernel\-\_\-impl.\-cuh}.



Odwołuje się do \hyperlink{particles__kernel__impl_8cuh_source_l00059}{operator()()}.


\begin{DoxyCode}
00051 : \hyperlink{structintegrate__functor_a06dce1826719cd5b2a9fdd9f566da754}{deltaTime}(delta\_time) \{\}
\end{DoxyCode}


Oto graf wywołań dla tej funkcji\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=306pt]{structintegrate__functor_a13075d4c547ba22c37137ff2b874ae45_cgraph}
\end{center}
\end{figure}




\subsection{Dokumentacja funkcji składowych}
\hypertarget{structintegrate__functor_a772e86ead8690332beb50911e4448f81}{\index{integrate\-\_\-functor@{integrate\-\_\-functor}!operator()@{operator()}}
\index{operator()@{operator()}!integrate_functor@{integrate\-\_\-functor}}
\subsubsection[{operator()}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Tuple $>$ \-\_\-\-\_\-device\-\_\-\-\_\- void integrate\-\_\-functor\-::operator() (
\begin{DoxyParamCaption}
\item[{Tuple}]{t}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{structintegrate__functor_a772e86ead8690332beb50911e4448f81}


nowe położenie 


\begin{DoxyParams}{Parametry}
{\em t} & para położenia i prędkości wylicza nowe położenie i sprawdza czy położenie nie jest za brzegiem \\
\hline
\end{DoxyParams}
$<$ odbijanie sie od kuli 

Definicja w linii \hyperlink{particles__kernel__impl_8cuh_source_l00059}{59} pliku \hyperlink{particles__kernel__impl_8cuh_source}{particles\-\_\-kernel\-\_\-impl.\-cuh}.



Odwołuje się do \hyperlink{particles__kernel__impl_8cuh_source_l00059}{operator()()}.



Odwołania w \hyperlink{particles__kernel__impl_8cuh_source_l00051}{integrate\-\_\-functor()} i \hyperlink{particles__kernel__impl_8cuh_source_l00059}{operator()()}.


\begin{DoxyCode}
00060     \{
00061         \textcolor{keyword}{volatile} float4 posData = thrust::get<0>(t);
00062         \textcolor{keyword}{volatile} float4 velData = thrust::get<1>(t);
00063         float3 pos = make\_float3(posData.x, posData.y, posData.z);
00064         float3 vel = make\_float3(velData.x, velData.y, velData.z);
00065 
00066         vel += \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_ae7508eba5dd90859215b59d19e001bb9}{gravity} * \hyperlink{structintegrate__functor_a06dce1826719cd5b2a9fdd9f566da754}{deltaTime};
00067         vel *= \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7058bad8c867d9d42d8c9d842638ebea}{globalDamping};
00068 
00069         \textcolor{comment}{// new position = old position + velocity * deltaTime}
00070         pos += vel * \hyperlink{structintegrate__functor_a06dce1826719cd5b2a9fdd9f566da754}{deltaTime};
00071 
00072         \textcolor{comment}{// set this to zero to disable collisions with cube sides}
00073 \textcolor{preprocessor}{#if 0}
00074 \textcolor{preprocessor}{}
00075         \textcolor{keywordflow}{if} (pos.x > 1.0f - \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7e131c24e1020c44173deb0f57a8c4af}{particleRadius})
00076         \{
00077             pos.x = 1.0f - \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7e131c24e1020c44173deb0f57a8c4af}{particleRadius};
00078             vel.x *= \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a4da0c7593d6569e48ee50e7d0c7576f9}{boundaryDamping};
00079         \}
00080 
00081         \textcolor{keywordflow}{if} (pos.x < -1.0f + \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7e131c24e1020c44173deb0f57a8c4af}{particleRadius})
00082         \{
00083             pos.x = -1.0f + \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7e131c24e1020c44173deb0f57a8c4af}{particleRadius};
00084             vel.x *= \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a4da0c7593d6569e48ee50e7d0c7576f9}{boundaryDamping};
00085         \}
00086 
00087         \textcolor{keywordflow}{if} (pos.y > 1.0f - \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7e131c24e1020c44173deb0f57a8c4af}{particleRadius})
00088         \{
00089             pos.y = 1.0f - \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7e131c24e1020c44173deb0f57a8c4af}{particleRadius};
00090             vel.y *= \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a4da0c7593d6569e48ee50e7d0c7576f9}{boundaryDamping};
00091         \}
00092 
00093         \textcolor{keywordflow}{if} (pos.z > 1.0f - \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7e131c24e1020c44173deb0f57a8c4af}{particleRadius})
00094         \{
00095             pos.z = 1.0f - \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7e131c24e1020c44173deb0f57a8c4af}{particleRadius};
00096             vel.z *= \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a4da0c7593d6569e48ee50e7d0c7576f9}{boundaryDamping};
00097         \}
00098 
00099         \textcolor{keywordflow}{if} (pos.z < -1.0f + \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7e131c24e1020c44173deb0f57a8c4af}{particleRadius})
00100         \{
00101             pos.z = -1.0f + \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7e131c24e1020c44173deb0f57a8c4af}{particleRadius};
00102             vel.z *= \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a4da0c7593d6569e48ee50e7d0c7576f9}{boundaryDamping};
00103         \}
00104 
00105 \textcolor{preprocessor}{#endif}
00106 \textcolor{preprocessor}{}
00108 \textcolor{preprocessor}{#if 1}
00109 \textcolor{preprocessor}{}                \textcolor{keywordtype}{float} xk=pos.x*pos.x;
00110                 \textcolor{keywordtype}{float} yk=pos.y*pos.y;
00111                 \textcolor{keywordtype}{float} zk=pos.z*pos.z;
00112                 \textcolor{keywordtype}{float} r=\hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_af41979948fdd8f76fe28ce2b43eb24cd}{bigradius};\textcolor{comment}{//- params.particleRadius;}
00113                 \textcolor{keywordflow}{if}(xk+yk+zk > r*r + FLT\_EPSILON )
00114                 \{
00115                         r-=\hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7e131c24e1020c44173deb0f57a8c4af}{particleRadius}*4;
00116                         \textcolor{comment}{/*vel.x*=params.boundaryDamping;}
00117 \textcolor{comment}{                        vel.y*=params.boundaryDamping;}
00118 \textcolor{comment}{                        vel.z*=params.boundaryDamping;*/}
00119                         vel.x=0.0f;
00120                         vel.y=0.0f;
00121                         vel.z=0.0f;
00122                         \textcolor{keywordtype}{float} theta=atan(pos.z/sqrt(pos.x*pos.x+pos.y*pos.y));
00123                         \textcolor{keywordtype}{float} fi=atan(pos.y/pos.x);
00124                         pos.z=r*sin(theta);
00125                         \textcolor{keywordtype}{float} rr=r*cos(theta);
00126                         pos.x=rr*cos(fi);
00127                         pos.y=rr*sin(fi);
00128                 \}
00129 \textcolor{preprocessor}{#endif}
00130 \textcolor{preprocessor}{}
00131 \textcolor{comment}{//dolna plaszczyzna}
00132 \textcolor{preprocessor}{#if 0}
00133 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (pos.y < -1.0f + \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7e131c24e1020c44173deb0f57a8c4af}{particleRadius})
00134         \{
00135             pos.y = -1.0f + \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a7e131c24e1020c44173deb0f57a8c4af}{particleRadius};
00136             vel.y *= \hyperlink{particles__kernel__impl_8cuh_a8db8938e28edd17862daf58651051bdc}{params}.\hyperlink{struct_sim_params_a4da0c7593d6569e48ee50e7d0c7576f9}{boundaryDamping};
00137         \}
00138 \textcolor{preprocessor}{#endif}
00139 \textcolor{preprocessor}{}
00140         \textcolor{comment}{// store new position and velocity}
00141         thrust::get<0>(t) = make\_float4(pos, posData.w);
00142         thrust::get<1>(t) = make\_float4(vel, velData.w);
00143     \}
\end{DoxyCode}


Oto graf wywołań dla tej funkcji\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=175pt]{structintegrate__functor_a772e86ead8690332beb50911e4448f81_cgraph}
\end{center}
\end{figure}




Oto graf wywoływań tej funkcji\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=306pt]{structintegrate__functor_a772e86ead8690332beb50911e4448f81_icgraph}
\end{center}
\end{figure}




\subsection{Dokumentacja atrybutów składowych}
\hypertarget{structintegrate__functor_a06dce1826719cd5b2a9fdd9f566da754}{\index{integrate\-\_\-functor@{integrate\-\_\-functor}!delta\-Time@{delta\-Time}}
\index{delta\-Time@{delta\-Time}!integrate_functor@{integrate\-\_\-functor}}
\subsubsection[{delta\-Time}]{\setlength{\rightskip}{0pt plus 5cm}float integrate\-\_\-functor\-::delta\-Time}}\label{structintegrate__functor_a06dce1826719cd5b2a9fdd9f566da754}


Definicja w linii \hyperlink{particles__kernel__impl_8cuh_source_l00048}{48} pliku \hyperlink{particles__kernel__impl_8cuh_source}{particles\-\_\-kernel\-\_\-impl.\-cuh}.



Dokumentacja dla tej struktury została wygenerowana z pliku\-:\begin{DoxyCompactItemize}
\item 
\hyperlink{particles__kernel__impl_8cuh}{particles\-\_\-kernel\-\_\-impl.\-cuh}\end{DoxyCompactItemize}
